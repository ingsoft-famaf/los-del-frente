{% extends 'base.html' %}
{% block title %} Detail {% endblock %}

{% block content %}
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>
var enable_tagging = false

function activate_tagging() {
   document.getElementById('welcomeDiv').style.display = "block";
   eneable_tagging = true;
}

function cargarEtiquetas() {
    $.ajax({
      url: "/tags",
      data: {'photo_id':{{ photo.pk }}, 'x':a, 'y': b},
      context: document.body
    }).done(function() {
      alert("You are correctly tagged on this photo");
    }).fail(function(){
      console.log("Error cargando etiquetas");
    });
    eneable_tagging = false;
    document.getElementById('welcomeDiv').style.display = "none";
}

function etiquetar(a, b) {
    $.ajax({
      url: "/addtag",
      data: {'photo_id':{{ photo.pk }}, 'x':a, 'y': b},
      context: document.body
    }).done(function() {
      alert("You are correctly tagged on this photo");
    });
    eneable_tagging = false;
    document.getElementById('welcomeDiv').style.display = "none";
}

$(function() {
$("#foto img").click(function(e) {
  if (eneable_tagging == true) {
  var offset = $(this).offset();
  var relativeX = Math.round(e.pageX - offset.left);
  var relativeY = Math.round(e.pageY - offset.top);
  alert('the position of your tag is X : '+relativeX+'  Y : '+relativeY);
  etiquetar(relativeX, relativeY);
  }
});
});



</script>
<style>
  article {
    color: #FFF;
    width: 800px;
    position: relative;
    left: 50%;
    margin-left: -400px;
  }
  .img-container {
    position: relative;
  }
  .img-container img {
    width: 100%;
  }
  .img-container .details {
    background-color: rgba(0, 0, 0, 0.36);
    color: rgba(240, 239, 239, 1);
    position: absolute;
    left: 30px;
    bottom: 30px;
    padding: 10px;
  }
  .img-container h1 {
    font-size: 20px; margin-top: 5px;
  }
  .img-container h2 {    
    font-size: 15px; margin-top: 0px;
  }
</style>
<article>
<legend>Details</legend>
<div id="welcomeDiv"  style="display:none;" class="answer_list" > Haga click en la posici√≥n que se quiere etiquetar</div>
<a id = "foto">
<div class="img-container">
  <span class="tag">- Pepe</span>
<img src="{{ object.picture.url }}" class="img-responsive img-detail" alt="">
<div class="details">
  <h1>{{ object.place }}</h1>
  <h2>{{ object.date }} at {{object.time}}</h2>
</div>
</div>
</a>

{% if user.is_staff %}
<input type="button" onclick="location.href='{% url 'photos:delete' photo.pk %}';" value="Eliminar" />
{% endif %}
<input type="button" onclick="activate_tagging()"  value="Etiquetarse" />
</article>

{% endblock %}

